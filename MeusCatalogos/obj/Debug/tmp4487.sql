CREATE TABLE [dbo].[Users] (
    [UserId] [int] NOT NULL IDENTITY,
    [Name] [nvarchar](200) NOT NULL,
    [Email] [nvarchar](200) NOT NULL,
    [PasswordDigest] [nvarchar](max) NOT NULL,
    [Timestamp] rowversion NOT NULL,
    [Password] [nvarchar](max),
    [Company_CompanyId] [int],
    CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([UserId])
)
CREATE INDEX [IX_Company_CompanyId] ON [dbo].[Users]([Company_CompanyId])
CREATE UNIQUE INDEX [IX_Email] ON [dbo].[Users]([Email])
CREATE TABLE [dbo].[Companies] (
    [CompanyId] [int] NOT NULL IDENTITY,
    [Name] [nvarchar](200) NOT NULL,
    CONSTRAINT [PK_dbo.Companies] PRIMARY KEY ([CompanyId])
)
CREATE UNIQUE INDEX [IX_Name] ON [dbo].[Companies]([Name])
CREATE TABLE [dbo].[Catalogs] (
    [CatalogId] [int] NOT NULL IDENTITY,
    [Name] [nvarchar](200) NOT NULL,
    [Timestamp] [varbinary](max),
    [Company_CompanyId] [int],
    [UserCreated_UserId] [int],
    [ImageCover_ImageId] [int],
    CONSTRAINT [PK_dbo.Catalogs] PRIMARY KEY ([CatalogId])
)
CREATE INDEX [IX_Company_CompanyId] ON [dbo].[Catalogs]([Company_CompanyId])
CREATE INDEX [IX_UserCreated_UserId] ON [dbo].[Catalogs]([UserCreated_UserId])
CREATE INDEX [IX_ImageCover_ImageId] ON [dbo].[Catalogs]([ImageCover_ImageId])
CREATE TABLE [dbo].[CatalogItems] (
    [ItemId] [int] NOT NULL IDENTITY,
    [Name] [nvarchar](200) NOT NULL,
    [Description] [nvarchar](max),
    [Price] [decimal](18, 2) NOT NULL,
    [Timestamp] rowversion NOT NULL,
    [Catalog_CatalogId] [int],
    [ImageCover_ImageId] [int],
    [Category_CategoryId] [int],
    CONSTRAINT [PK_dbo.CatalogItems] PRIMARY KEY ([ItemId])
)
CREATE INDEX [IX_Catalog_CatalogId] ON [dbo].[CatalogItems]([Catalog_CatalogId])
CREATE INDEX [IX_ImageCover_ImageId] ON [dbo].[CatalogItems]([ImageCover_ImageId])
CREATE INDEX [IX_Category_CategoryId] ON [dbo].[CatalogItems]([Category_CategoryId])
CREATE TABLE [dbo].[Images] (
    [ImageId] [int] NOT NULL IDENTITY,
    [Url] [nvarchar](max) NOT NULL,
    CONSTRAINT [PK_dbo.Images] PRIMARY KEY ([ImageId])
)
CREATE TABLE [dbo].[CatalogCategories] (
    [CategoryId] [int] NOT NULL IDENTITY,
    [Name] [nvarchar](200) NOT NULL,
    [Timestamp] rowversion NOT NULL,
    CONSTRAINT [PK_dbo.CatalogCategories] PRIMARY KEY ([CategoryId])
)
ALTER TABLE [dbo].[Users] ADD CONSTRAINT [FK_dbo.Users_dbo.Companies_Company_CompanyId] FOREIGN KEY ([Company_CompanyId]) REFERENCES [dbo].[Companies] ([CompanyId])
ALTER TABLE [dbo].[Catalogs] ADD CONSTRAINT [FK_dbo.Catalogs_dbo.Companies_Company_CompanyId] FOREIGN KEY ([Company_CompanyId]) REFERENCES [dbo].[Companies] ([CompanyId])
ALTER TABLE [dbo].[Catalogs] ADD CONSTRAINT [FK_dbo.Catalogs_dbo.Users_UserCreated_UserId] FOREIGN KEY ([UserCreated_UserId]) REFERENCES [dbo].[Users] ([UserId])
ALTER TABLE [dbo].[Catalogs] ADD CONSTRAINT [FK_dbo.Catalogs_dbo.Images_ImageCover_ImageId] FOREIGN KEY ([ImageCover_ImageId]) REFERENCES [dbo].[Images] ([ImageId])
ALTER TABLE [dbo].[CatalogItems] ADD CONSTRAINT [FK_dbo.CatalogItems_dbo.Catalogs_Catalog_CatalogId] FOREIGN KEY ([Catalog_CatalogId]) REFERENCES [dbo].[Catalogs] ([CatalogId])
ALTER TABLE [dbo].[CatalogItems] ADD CONSTRAINT [FK_dbo.CatalogItems_dbo.Images_ImageCover_ImageId] FOREIGN KEY ([ImageCover_ImageId]) REFERENCES [dbo].[Images] ([ImageId])
ALTER TABLE [dbo].[CatalogItems] ADD CONSTRAINT [FK_dbo.CatalogItems_dbo.CatalogCategories_Category_CategoryId] FOREIGN KEY ([Category_CategoryId]) REFERENCES [dbo].[CatalogCategories] ([CategoryId])
CREATE TABLE [dbo].[__MigrationHistory] (
    [MigrationId] [nvarchar](255) NOT NULL,
    [Model] [varbinary](max) NOT NULL,
    [ProductVersion] [nvarchar](32) NOT NULL,
    CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId])
)
BEGIN TRY
    EXEC sp_MS_marksystemobject 'dbo.__MigrationHistory'
END TRY
BEGIN CATCH
END CATCH
INSERT INTO [__MigrationHistory] ([MigrationId], [Model], [ProductVersion]) VALUES ('201306161757313_InitialCreate', 0x1F8B0800000000000400DD5DC96E1CB716DD0778FFD0A8D54B8074C94E167E462B81D3B20221916DB8E56C05AA8A6A155E4D61B165E9DBB2C827E51742D6C8B9C86AF6A48DA12E92977738BCBC9CAEFFF9EBEFC5CF4F593A7B84A84A8AFC3C78353F0B66308F8A38C9D7E7C106DF7FFF26F8F9A7FF7CB3781F674FB33FBA7A3FD07AA4655E9D070F18976FC3B08A1E6006AA799644A8A88A7B3C8F8A2C047111BE3E3BFB5FF8EA5508098980D09ACD169F37394E3258FF203F97451EC1126F407A5DC430ADDAEFA46455539D7D0019AC4A10C1F3E01A6EAA25C0202DD645356FEA07B3776902082F2B98DE07B3F2C7B75F2AB8C2A8C8D7AB12E004A437CF2524E5F720AD60CBF9DBF2475BE6CF5E53E64390E70526E48A7C92F0412F1611EC3D51007EA66CD5C29D078463C4D620757E83CFDC07F2E9132A4A88F0F36778CFB4BB8A8359C8B70DC5C67D53A11D65E13CB8CAF10FAF83D9874D9A82BB14F69A22AA5CE102C15F610E11C030FE0430868840E02A86B50852CF423FF4DFAE17621282AB6076993CC1F87798AFF143DFD33578EABE109D05B32F794260481A61B4810ACECCBDBECF4092EEBFDB4FA0AABE1628BE48D6B0C28EFD933FB7EDFF860CAA0A83ACECBAFE25C9012236A2236C831019DACFD735F99A975196DE3841625964E50643198C1A2D79D54FF35BE8F803784CD6F5881558A0AC829C28E6334CEBF2EA21291BFF316FCB6EE90821AEE51215D9E7221D1A3505B73700AD21B571A12A5D151B14090C2DC261D41B7D41C7DD0477D0369DE21198A62FC42968CDDF9A76BAF13BF3AA8DDF41C31A8DCD7CA6E1A829BCED21CBF0C417C99014CAB70365436C12289BA6934039347D21A0B475D936DE70AAFBBBC23033A28D56B8ED2C2E238E2DD6A18EABA342DE64FF6C3F20A461AA19302E7E638920A82739036B5C3D993DA658CB225BC795CDAB0CACE1B22061BD914BB69ACCE450AAE591A9A262D1D5B550C44C712FB4DD14DFD2B57B998EE50256114ACA66B9B2EB404B8CF05012F5225FC028C90089C63F21F257BBD02491E52A02949E4AE72719E58E4DEFBEFCAD66342A7DB25F8F517761F41A420D23AF23DE6344A3705D20E3FCD0E9A3ADA8D5695D3EA6D4A6D2564EAE1677927BA30D27F9B7AEE1AE1DDC17E4BAD6765EEBBACE25BDE1A785AB75DB89F16ADFF665CE2BC7E87D75E87857554594D40E820F2CDBF51D2FE8FB3C9E19177B8DA6996522116493E2A44C9388F47E1E9CCDE7AF24FDE9C8F671F340B6DE0414687E278ACA083522AB626ED1B2669A6818B99948CDCCE7287585F8FD0438A6D5894A60A62E1B4E55F3985755286640A68366C2D8952E340E526B33619AF40D097E8295C90F13B97F7DDCAAF7DB245EE565E528742D3420EFDE4C7033138466D7A8632C2A17AC5E84572D73471CA217E9ED5D819D1B9822FB6E877F33239249198384CCA2ADFCD74BFA053E61496C5A7B0531BF433A4CAB9C4124D1F8C60D6C13A822D0437A8C46BF272A93E8546E4782B898DC40A6715C23A46A63A888B456B2E3A475621AC5888E4EA0C99859D474BF5DCDD451EE678BB1EF58C4D3CBC1D934B425D3A19A21D3322A86D5BC703682ABD6CD0AF1C74220EB20885505872B93360C618F4CCFB75AD885BA59333A67E812196DAB1F8533644876E3CF376EDAA1360A1C45A8641F2C79800E1F1EC90459CFE24B47C306BB563DEAC8C92A76B2C0BF55B464E3A2B6D001B793AFD7833698B20EA7A6EA431540EDCEDFDA3915278762E74CEC94E1D98974DB0A7D10355C4C0A9B9B49DD0DA650738569710DCA32C9D7CC95A6F6CB6CD5DC675A7EBF72BF4D943534C2A8525C2AEAB9ED7BC20522920BA574BCC4F0324115BE20EABB0374E365196752B5D190B1EB878D1C655B75E14E579BFEDDC6A48A2B5D73F93E14ABBD4B225006735CCB0605BCCBCD66F426194801D25C825A16E926CB4D17AA4C549A7D389646F3C59E427B5D8925D17EB2A721DE3D62898965F65499DD3E9620F3D99D43356F2A4A8B50B0B708AB50C29530B645905A41789848B686B16682B440B2B6A54EBDCCFD1D56BFDA1B41265AF6903E9489BA69617B0BA997053616D2B5D45A68B8CCC25948773DC68F857C0EEDC35ABB099B7D595CBE6EE06275756B9DAEBBAB06ACA2D5D716766B73EE52004B882B7070E9CD413FE7CF9B4F2F12876D04B935021567C135A131EC69DA6951D71D0073B0531F279BE8D4E7BB5C8C8494A1C961BD03B306F6E522742B7F7B37A1A7609824FA13646196D09C4A9BA8BDCC69825FB1A982B77E4BD42E3EEB6ADB2C27E8BA531D7AF1BBA7B25626846DB786F08D6AA9E7C495C9767D6CC9A4CB42C9C816594AC6497D1E7355D163FFFEC8DF497671CDEE0E12D5F6B17DD830B471880E5426D16F10DBA2C71852DE1A424B57F4E8F7C62D597589813C60684C035E31C46E8B39C0886DE60F49F22E98AD85B4F142434D1B3A6C812579F7EF28E134AE05DF3EA93D9A70734A6D23AF5E893B7BB0774BC620E676698866B6F34CDCD9CB5162C94209BEC0349CE1D8E168A86FB9D9A1B78778527374E190FA60CACBBC7BE261117FEA65891CAECDF6E8519C6B6D19AB76D426C5AD768C1E3F86C615E10D44EE31914D3CE400A1538983A6C7408740908F48483A5815ABF41B08FD01AB7090BA680F35C7134648A79C4D15FA1CA9784C627AC2B97AAEC8643FA715E6AB3FD3659AC01C0F15AE419EDCC30ADF14FF87797D87FE8D907162423688B0AAE2F4985342245405A32F141C1F0F349B4F4D07F92340D10340F203856D923D78A3AACEE5D091FF6F069EBEDDFEED042ABEB6C957B4BA1E5E3C4C146094759B177D8AD883818989D6A9653D3856DC9FDA43FD63D5A3C5A82484EFEA474D7B1E2A6A972C866B9389A9666EEF8358B7D3B0CFA7DCA7033DC523EDADDC34F7F03ADEF9C3EB5D4E5F8A0DDC43205FC998BC7DE37B1C1DFCB5F04EC610F350D825903ADDC7BFA7E3897638B677F43AD7C383DCE63593DB035C4280A005226A3C9092156C851159C34A47DCC415E751528254E05A5EDA3BC4B354993D61B1E4029630A7A062A573E8CEBCB9DA531706C5983276F11ED31B00B8B35FD7177D270203FD05C7E34782CD2355AB417C7438B01E9CFAEDEA9D20C06EA77C8F10B078A9DB3EC2747F3C7B600CE8AE015A47753B4381DD66F7FE50E092C3625A4A0915A5E669F0D45C07D3A60717676DDAE6778585E636B4B657F3D5A23D2363DF3EE200C03888AFB006C5B1FA0BAB1427FC659BA979478E0427E337975DD6BCBBF624369781BCA3469D19437E0D291A57CE90A14D90D19C319E07F15D41ECDFAC8CD54F71D5B9339E4D993354C4F56F9F35B9284C7935941D68DEE11AB26E646349370CFDB4196A6DD272E8B372A8E86B1E019B337628CD21D63048B3D43FCFDF4B5A0FC5337929C188624D255E843FB6D402138513460077BBE448330758D9E300427A4C07C08D65E6B5D3C185DC498E191B96F51185E66AAF5F913DE78FD9C2BE7B147A70E7BE72C2885388F275D8FE94E090D342BE6245822EE67FEE21016095AC0712F4FE580E232EDCEAEB5CE5F74517020A1C75558413896B88414C647C8770720F224C8A235855759AD33F40BA81F4E6CF1D8CAFF28F1B5C6E301119667729A74C1A3D9AFAAF1377F03C2F3ED6C7B1950F11089B0911017ECC7FD92469DCF37DA93824D190A061697BF2426D89E909CCFAB9A7F4A1C82D09B5EAEBA3E91B98952921567DCC57E011EA791BD721AFB1C54502D60864554B63684F7E12F8C5D9D34FFF02FC19B16F7B6A0000, '5.0.0.net45')
